<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Victorian Secondary School System</title>

<!-- Vega & Vega-Lite -->
<script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>

<!-- Bootstrap 5 CSS & Font Awesome -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
body { font-family: 'Poppins', sans-serif; background:#f7f7f7; margin:0; text-align:center; }
h1 { margin-top:40px; font-size:2.8em; color:#2c3e50; text-transform:uppercase; letter-spacing:1px; }
.intro-text { max-width:850px; margin:20px auto 40px; padding:25px; font-size:1.1em; line-height:1.7em; color:#555; text-align:justify; background:#fff; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.1);}
.vis-container { width:100%; height:100%; display:inline-block; margin:0; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.1); border-radius:12px; padding:0; }
.map-wrapper { position: relative; display: inline-block; width: 800px; height: 600px; }

.map-controls {
  position: absolute;
  top: 30px;
  right: 10px;
  z-index: 10;
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.map-controls button { width: 50px; height: 50px; }

.charts-wrapper {
  display: flex;
  justify-content: space-between;
  margin: 40px auto;
  width: 90%;
  gap: 20px;
}

.chart-box {
  flex: 1;
  height: 400px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
  padding:10px;
}
</style>
</head>
<body>

<h1>Victorian Secondary School System</h1>

<div class="intro-text">
  <p><strong>Background:</strong> Overview of Victoriaâ€™s secondary school system, enrolments, and performance across LGAs.</p>
</div>

<div class="map-wrapper">
  <div id="vic_school_map" class="vis-container"></div>

  <div class="map-controls">
    <button id="zoomIn" class="btn btn-outline-primary"><i class="fas fa-search-plus"></i></button>
    <button id="zoomOut" class="btn btn-outline-primary"><i class="fas fa-search-minus"></i></button>
    <button id="moveUp" class="btn btn-outline-primary"><i class="fas fa-arrow-up"></i></button>
    <button id="moveDown" class="btn btn-outline-primary"><i class="fas fa-arrow-down"></i></button>
    <button id="moveLeft" class="btn btn-outline-primary"><i class="fas fa-arrow-left"></i></button>
    <button id="moveRight" class="btn btn-outline-primary"><i class="fas fa-arrow-right"></i></button>
    <button id="showSchools" class="btn btn-outline-success"><i class="fas fa-school"></i></button>
  </div>
</div>

<div class="charts-wrapper">
  <div class="chart-box" id="scatterplot"></div>
  <div class="chart-box" id="linechart"></div>
</div>

<script>
/* --- Map --- */
const specVicSchoolMap = "school_lga_choropleth_map.json";
let view, zoom=20000, lon=0, lat=0;

vegaEmbed('#vic_school_map', specVicSchoolMap, {actions:false})
  .then(result => { view = result.view; setupMapControls(); })
  .catch(console.error);

function setupMapControls() {
  document.getElementById("zoomIn").onclick = () => updateZoom(5000);
  document.getElementById("zoomOut").onclick = () => updateZoom(-5000);
  document.getElementById("moveUp").onclick = () => updatePosition(0,0.1);
  document.getElementById("moveDown").onclick = () => updatePosition(0,-0.1);
  document.getElementById("moveLeft").onclick = () => updatePosition(-0.1,0);
  document.getElementById("moveRight").onclick = () => updatePosition(0.1,0);

  function updateZoom(delta) {
    zoom = Math.max(5000, Math.min(60000, zoom+delta));
    view.signal("zoom_level", zoom).runAsync();
  }

  function updatePosition(dLon,dLat){
    lon = Math.max(-2, Math.min(2, lon+dLon));
    lat = Math.max(-2, Math.min(2, lat+dLat));
    view.signal("lon_offset", lon).signal("lat_offset", lat).runAsync();
  }

  let schoolsShown = false;
  document.getElementById("showSchools").onclick = () => {
    schoolsShown = !schoolsShown;
    view.signal("show_schools", schoolsShown).runAsync();
  };
}

/* --- Scatterplot --- */
vegaEmbed('#scatterplot', "school_scatterplot.json", {actions:false, renderer:"canvas"})
  .catch(console.error);

/* --- Line chart --- */
vegaEmbed('#linechart', "school_linechart.json", {actions:false, renderer:"canvas"})
  .catch(console.error);
</script>

</body>
</html>
