{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 800,
  "height": 600,
  "title": "Average Median VCE Study Score by Local Government Area (LGA)",
  "config": {
    "title": {
      "font": "Fira Sans",
      "fontSize": 18,
      "fontWeight": "bold",
      "color": "#333"
    }
  },
  "params": [
    {"name": "zoom_level", "value": 20000},
    {"name": "lon_offset", "value": 0},
    {"name": "lat_offset", "value": 0},
    {"name": "show_schools", "value": false}
  ],
  "projection": {
    "type": "equirectangular",
    "center": {"expr": "[144.9631 + lon_offset, -37.8136 + lat_offset]"},
    "scale": {"expr": "zoom_level"}
  },
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/JeremyOckerby/FIT3179/main/vic_lga.json",
        "format": {"type": "topojson", "feature": "vic_lga"}
      },
      "mark": {"type": "geoshape", "fill": "#ddd", "stroke": "white"},
      "encoding": {
        "tooltip": {
          "field": "properties.ABB_NAME",
          "type": "nominal",
          "title": "LGA"
        }
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/JeremyOckerby/FIT3179/main/vic_lga.json",
        "format": {"type": "topojson", "feature": "vic_lga"}
      },
      "transform": [
        {
          "lookup": "properties.ABB_NAME",
          "from": {
            "data": {
              "url": "https://raw.githubusercontent.com/JeremyOckerby/FIT3179/refs/heads/main/lga_data.csv"
            },
            "key": "LGA_Name",
            "fields": ["Average_Median_Study_Score"]
          }
        }
      ],
      "mark": {"type": "geoshape", "stroke": "#fff", "strokeWidth": 0.5},
      "encoding": {
        "color": {
          "field": "Average_Median_Study_Score",
          "type": "quantitative",
          "scale": {"scheme": "blues"},
          "legend": {"title": "Median Study Score", "format": ".2s"}
        },
        "tooltip": [
          {"field": "properties.ABB_NAME", "type": "nominal", "title": "LGA"},
          {"field": "Average_Median_Study_Score", "type": "quantitative", "title": "Median Study Score", "format": ".2f"}
        ]
      }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/JeremyOckerby/FIT3179/refs/heads/main/Secondary_Schools_Combined_With_VCE.csv"
      },
      "transform": [
        {"filter": "show_schools"}
      ],
      "mark": {"type": "circle", "opacity": 0.8, "stroke": "#333", "strokeWidth": 0.5},
      "encoding": {
        "longitude": {"field": "X", "type": "quantitative"},
        "latitude": {"field": "Y", "type": "quantitative"},
        "size": {"field": "Secondary Total", "type": "quantitative", "title": "Total Enrolments", "scale": {"range": [5, 500]}},
        "color": {"field": "Median_VCE_study_score", "type": "quantitative", "scale": {"scheme": "reds"}, "legend": {"title": "Median Study Score"}},
        "tooltip": [
          {"field": "School_Name", "title": "School"},
          {"field": "LGA_Name", "title": "LGA"},
          {"field": "Secondary Total", "title": "Total Enrolments"},
          {"field": "Median_VCE_study_score", "title": "Median Study Score"}
        ]
      }
    }
  ]
}
